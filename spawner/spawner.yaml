---
region: us-east-1

# List the application ("host classes") and properties of them

# Instance types are from https://docs.google.com/a/amplify.com/spreadsheets/d/1KI4Cduq1NdBEtQX2mQMjKqYEDsjixTdUqYt4q8VZwO0/edit#gid=2140568744
# Application names are from https://docs.google.com/a/amplify.com/spreadsheets/d/1vtYyCL50Ii3wHeNDsWYlu-YVjjBSORzZQZOKvnLAgkM/edit#gid=2108299998
# Security group names are from https://docs.google.com/a/amplify.com/spreadsheets/d/1vtYyCL50Ii3wHeNDsWYlu-YVjjBSORzZQZOKvnLAgkM/edit#gid=2108299998

apps:

  # app-name:
  #   ami_app_name: other_thing # Optional.  Use this to override which AMI is used.  Will look for an AMI that has an application:other_thing tag.
  #   security_groups:
  #     - sg-name-01 # Array of SG names
  #     - sg-name-02 # Array of SG names
  #   instance_type: t1.micro # Required
  #   subnet_type: private # One of private, public, or lz.  Defaults to private.
  #   public_ip: True or False, defaults to false.

  ansible:
    ami_app_name: base # Playbook runs from base
    security_groups:
      - srl-default
      - srl-logging
      - omniti-fulton-office
    instance_type: t1.micro
    public_ip: True

  base:
    security_groups: []
    instance_type: t1.micro

  db-master:
    ami_app_name: base # TODO: remove this when the real AMI is available
    security_groups:
      - srl-default
      - srl-db
      - srl-logging
    instance_type: r3.2xlarge

  db-pgbouncer:
    ami_app_name: base # TODO: remove this when the real AMI is available
    security_groups:
      - srl-default
      - srl-db-client
      - srl-db-pgbouncer
      - srl-logging
    instance_type: m3.xlarge

  db-pgpool:
    ami_app_name: base # TODO: remove this when the real AMI is available
    security_groups:
      - srl-default
      - srl-db-client
      - srl-db-pool
      - srl-logging
    instance_type: m3.xlarge

  db-slave: # TODO: may be split; there are actually two - one for extraction and one for reporting
    ami_app_name: base # TODO: remove this when the real AMI is available
    security_groups:
      - srl-default
      - srl-db
      - srl-logging
    instance_type: r3.2xlarge

  gluster-server:
    ami_app_name: base # TODO: remove this when the real AMI is available
    security_groups:
      - srl-default
      - srl-glusterfs
      - srl-logging
    instance_type: m3.medium # TODO: verify

  hpz-db:
    ami_app_name: db # per doris
    security_groups:
      - srl-default
      - srl-db
      - srl-logging
    instance_type: m3.2xlarge

  hpz-web:
    ami_app_name: hpz-web
    security_groups:
      - srl-default
      - srl-db-client
      - srl-glusterfs-hpz-client
      - srl-logging
    instance_type: m3.xlarge

  loghost:
    ami_app_name: base 
    security_groups:
      - srl-default
      - srl-logstash
    instance_type: m2.xlarge 

  lz:
    ami_app_name: lz
    security_groups:
      - srl-default
      - srl-logging
    instance_type: m3.xlarge

  memcached:
    ami_app_name: memcached 
    security_groups:
      - srl-default
      - srl-memcached
      - srl-logging
    instance_type: m2.4xlarge

  file-trigger:
    ami_app_name: file-trigger 
    security_groups:
      - srl-default
      - srl-logging
      - srl-rmq-client
      - srl-glusterfs-udl-client
    instance_type: t1.micro 

  file-grabber:
    ami_app_name: file-grabber
    security_groups:
      - srl-default
      - srl-logging
    instance_type: t1.micro

  migrate-db:
    ami_app_name: base # TODO: remove this when the real AMI is available
    security_groups:
      - srl-default
      - srl-db
      - srl-db-client
      - srl-db-pool-pcp
      - srl-rmq-client
      - srl-logging
    instance_type: m3.2xlarge

  migrate-rabbit:
    ami_app_name: rabbit
    security_groups:
      - srl-default
      - srl-logging
      - srl-rmq
    instance_type: m3.2xlarge

  #nat:
  #  ami_app_name: base # TODO: remove this when the real AMI is available
  #  security_groups: [] # TODO
  #  instance_type: m3.medium

  reporting-cache-warmer:
    ami_app_name: reporting-generator # per doris
    security_groups:
      - srl-default
      - srl-memcached
      - srl-logging
    instance_type: m3.large

  reporting-generator-pdf:
    ami_app_name: reporting-generator # per doris
    security_groups:
      - srl-default
      - srl-rmq-client
      - srl-logging
    instance_type: m3.large

  reporting-rabbit-services:
    ami_app_name: rabbit
    security_groups:
      - srl-default
      - srl-rmq
      - srl-logging
    instance_type: m3.xlarge

  reporting-rabbit-extract:
    ami_app_name: rabbit
    security_groups:
      - srl-default
      - srl-db-pool-client
      - srl-rmq-client
      - srl-web-client
      - srl-glusterfs-extract-client
      - srl-logging
    instance_type: m3.xlarge

  reporting-web:
    ami_app_name: reporting-web
    security_groups:
      - srl-default
      - srl-db-pool-client
      - srl-rmq-client
      - srl-memcached
      - srl-web
      - srl-logging
    instance_type: m3.xlarge

  reporting-worker-extract:
    ami_app_name: reporting-worker-extract 
    security_groups:
      - srl-default
      - srl-db-pool-client
      - srl-rmq-client
      - srl-web-client
      - srl-glusterfs-extract-client
      - srl-logging
    instance_type: m3.2xlarge

  reporting-worker-pdf:
    ami_app_name: reporting-worker-pdf
    security_groups:
      - srl-default
      - srl-rmq-client
      - srl-sso-client
      - srl-web-client
      - srl-glusterfs-pdf-client
      - srl-logging
    #instance_type: r3.2xlarge # TODO: existing image is PV, r3 requires HVM
    instance_type: m2.4xlarge

  tsb-rabbit:
    ami_app_name: rabbit
    security_groups:
      - srl-default
      - srl-rmq
      - srl-logging
    instance_type: m3.xlarge

  tsb-trigger:
    ami_app_name: tsb-trigger
    security_groups:
      - srl-default
      - srl-logging
    instance_type: m3.large

  tsb-web:
    ami_app_name: tsb-web
    security_groups:
      - srl-default
      - srl-web
      - srl-rmq-client
      - srl-sso-client
      - srl-logging
    instance_type: m3.xlarge

  tsb-worker:
    ami_app_name: tsb-worker
    security_groups:
      - srl-default
      - srl-db-client
      - srl-rmq-client
      - srl-glusterfs-udl-client
      - srl-logging
    instance_type: m3.xlarge

  udl:
    ami_app_name: udl
    security_groups:
      - srl-default
      - srl-db-client
      - srl-logging
    instance_type: m3.2xlarge

  udl-db:
    ami_app_name: base # TODO: remove this when the real AMI is available
    security_groups:
      - srl-default
      - srl-db
      - srl-logging
    instance_type: m3.2xlarge

  udl-rabbit:
    ami_app_name: rabbit
    security_groups:
      - srl-default
      - srl-rmq
      - srl-logging
    instance_type: m3.xlarge

  #vpn:
  #  ami_app_name: base # TODO: remove this when the real AMI is available
  #  security_groups: # TODO
  #    - srl-default
  #  instance_type: m3.medium

